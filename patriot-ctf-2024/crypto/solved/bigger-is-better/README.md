# Bigger is Better

I heard choosing a small value for e when creating an RSA key pair is a bad idea. So I switched it up!

## Solution

```txt
N = 0xa0d9f425fe1246c25b8c3708b9f6d7747dd5b5e7f79719831c5cbe19fb7bab66ed62719b3fc6090120d2cfe1410583190cd650c32a4151550732b0fc97130e5f02aa26cb829600b6ab452b5b11373ec69d4eaae6c392d92da8bcbea85344af9d4699e36fdca075d33f58049fd0a9f6919f3003512a261a00985dc3d9843a822974df30b81732a91ce706c44bde5ff48491a45a5fa8d5d73bba5022af803ab7bd85250e71fc0254fcf078d21eaa5d38724014a85f679e8a7a1aad6ed22602465f90e6dd8ef95df287628832850af7e3628ad09ff90a6dbdf7a0e6d74f508d2a6235d4eae5a828ac95558bbdf72f39af5641dfe3edb0cdaab362805d926106e2af
e = 0x5af5dbe4af4005564908a094e0eabb0a921b7482483a753e2a4d560700cb2b2dc9399b608334e05140f54d90fcbef70cec097e3f75395d0c4799d9ec3e670aca41da0892a7b3d038acb7a518be1ced8d5224354ce39e465450c12be653639a8215afb1ba70b1f8f71fc1a0549853998e2337604fca7edac67dd1e7ddeb897308ebf26ade781710e6a2fe4c533a584566ea42068d0452c1b1ecef00a781b6d31fbab893de0c9e46fce69c71cefad3119e8ceebdab25726a96aaf02a7c4a6a38d2f75f413f89064fef14fbd5762599ca8eb3737122374c5e34a7422ea1b3d7c43a110d3209e1c5e23e4eece9e964da2c447c9e5e1c8a6038dc52d699f9324fd6b9
c = 0x731ceb0ac8f10c8ff82450b61b414c4f7265ccf9f73b8e238cc7265f83c635575a9381aa625044bde7b34ad7cce901fe7512c934b7f6729584d2a77c47e8422c8c0fe2d3dd12aceda8ef904ad5896b971f8b79048e3e2f99f600bf6bac6cad32f922899c00fdc2d21fcf3d0093216bfc5829f02c08ba5e534379cc9118c347763567251c0fe57c92efe0a96c8595bac2c759837211aac914ea3b62aae096ebb8cb384c481b086e660f0c6249c9574289fe91b683609154c066de7a94eafa749c9e92d83a9d473cc88accd9d4c5754ccdbc5aa77ba9a790bc512404a81fc566df42b652a55b9b8ffb189f734d1c007b6cbdb67e14399182016843e27e6d4e5fca
```

https://github.com/RsaCtfTool/RsaCtfTool

```sh
git clone https://github.com/RsaCtfTool/RsaCtfTool.git
sudo apt-get install libgmp3-dev libmpc-dev
cd RsaCtfTool
pip3 install -r "requirements.txt"
./RsaCtfTool.py
```

```sh
python3 solve.py

./RsaCtfTool/RsaCtfTool.py --publickey ./key.pub --decryptfile ./cipher.txt
./RsaCtfTool/RsaCtfTool.py --publickey ./key.pub --private
```

https://ctf101.org/cryptography/what-is-rsa/

public key made of n and e
private key made of n and d

https://www.reddit.com/r/crypto/comments/9lyhwa/rsa_vulnerability_when_e_is_particularily_large/
d might be too small, try wiener attack

```sh
./RsaCtfTool/RsaCtfTool.py --publickey ./key.pub --private --attack wiener
```

```txt
-----BEGIN RSA PRIVATE KEY-----
MIIEYAIBAAKCAQEAoNn0Jf4SRsJbjDcIufbXdH3Vtef3lxmDHFy+Gft7q2btYnGb
P8YJASDSz+FBBYMZDNZQwypBUVUHMrD8lxMOXwKqJsuClgC2q0UrWxE3PsadTqrm
w5LZLai8vqhTRK+dRpnjb9ygddM/WASf0Kn2kZ8wA1EqJhoAmF3D2YQ6gil03zC4
FzKpHOcGxEveX/SEkaRaX6jV1zu6UCKvgDq3vYUlDnH8AlT88HjSHqpdOHJAFKhf
Z56KehqtbtImAkZfkObdjvld8odiiDKFCvfjYorQn/kKbb33oObXT1CNKmI11Orl
qCislVWLvfcvOa9WQd/j7bDNqrNigF2SYQbirwKCAQBa9dvkr0AFVkkIoJTg6rsK
kht0gkg6dT4qTVYHAMsrLck5m2CDNOBRQPVNkPy+9wzsCX4/dTldDEeZ2ew+ZwrK
QdoIkqez0Dist6UYvhztjVIkNUzjnkZUUMEr5lNjmoIVr7G6cLH49x/BoFSYU5mO
IzdgT8p+2sZ90efd64lzCOvyat54FxDmov5MUzpYRWbqQgaNBFLBsezvAKeBttMf
uriT3gyeRvzmnHHO+tMRnozuvaslcmqWqvAqfEpqONL3X0E/iQZP7xT71XYlmcqO
s3NxIjdMXjSnQi6hs9fEOhENMgnhxeI+Tuzp6WTaLER8nl4cimA43FLWmfkyT9a5
AkEAgakShPxLfnIuoWeBvCr7C8trVeDCl0TdCLQGUkARLpyyhhDhzk8nm3JfDYYV
ST1VkkCcDj6P8d2fjKRugQLksQKBgQDFxrMoGd5Eyvhml7TNWAUWbaQe+f+Udjm/
gGA9g9omWgb5E1WfuWgppR5BGG9X+koQp8hr4i6JZtwkw6hg4r8DI0k4SH0FnLzG
v0y7XH1V4VyPh/pGJjyj+K5RfPzBQs6jZZeb83kMfsq6RGL7bJvr21NDqungtdUC
tQty/y3zFQKBgQDQNG+bJrp8mNNyZ71DMGFY4p/loVGNMYTfIfYT2JggXZV7X13g
Sc9nS84F8ZEyU8OH3MefJZRihCOMdJqcuDVb2HqbPwdcaKIzlBKovEfOxiJZMObf
df/OMkqzpH/FGIzgAWTrrZEOb1QLDYETGmZdzWlL1VKir+MNHpgcNLT/swJBAIGp
EoT8S35yLqFngbwq+wvLa1XgwpdE3Qi0BlJAES6csoYQ4c5PJ5tyXw2GFUk9VZJA
nA4+j/Hdn4ykboEC5LECQQCBqRKE/Et+ci6hZ4G8KvsLy2tV4MKXRN0ItAZSQBEu
nLKGEOHOTyebcl8NhhVJPVWSQJwOPo/x3Z+MpG6BAuSxAoGAQ3VHiSy+K8m1EGi/
A6bgXtzTCJWxnaQwBDRAOuxeVaqDmSrwphmoVck9iYS858sW+vKwQd+2dJKEHwPI
SOQfSB/ijSlqmk86hE2DgGdYZVDYFEB0R7uvffRQhQum5BaD2pTDp+bE9BdY2AMg
2dr1v2C0PGY5r4mkKq4lfW5dq44=
-----END RSA PRIVATE KEY-----
```

```sh
./RsaCtfTool/RsaCtfTool.py -n 0xa0d9f425fe1246c25b8c3708b9f6d7747dd5b5e7f79719831c5cbe19fb7bab66ed62719b3fc6090120d2cfe1410583190cd650c32a4151550732b0fc97130e5f02aa26cb829600b6ab452b5b11373ec69d4eaae6c392d92da8bcbea85344af9d4699e36fdca075d33f58049fd0a9f6919f3003512a261a00985dc3d9843a822974df30b81732a91ce706c44bde5ff48491a45a5fa8d5d73bba5022af803ab7bd85250e71fc0254fcf078d21eaa5d38724014a85f679e8a7a1aad6ed22602465f90e6dd8ef95df287628832850af7e3628ad09ff90a6dbdf7a0e6d74f508d2a6235d4eae5a828ac95558bbdf72f39af5641dfe3edb0cdaab362805d926106e2af -e 0x5af5dbe4af4005564908a094e0eabb0a921b7482483a753e2a4d560700cb2b2dc9399b608334e05140f54d90fcbef70cec097e3f75395d0c4799d9ec3e670aca41da0892a7b3d038acb7a518be1ced8d5224354ce39e465450c12be653639a8215afb1ba70b1f8f71fc1a0549853998e2337604fca7edac67dd1e7ddeb897308ebf26ade781710e6a2fe4c533a584566ea42068d0452c1b1ecef00a781b6d31fbab893de0c9e46fce69c71cefad3119e8ceebdab25726a96aaf02a7c4a6a38d2f75f413f89064fef14fbd5762599ca8eb3737122374c5e34a7422ea1b3d7c43a110d3209e1c5e23e4eece9e964da2c447c9e5e1c8a6038dc52d699f9324fd6b9 --private --attack wiener --dumpkey

# Private key details:
# n: 20305605772088142254079724960884486005748847015497427301575410293505817279910746556529376931600618579467120276350191887301067237559338164615341364063895698445198450602100622547416422520569435203138576780851363672762744455872440594076326813879006337922017621673305730465334708327073147244529163919113400850500409784670385009784210553996344093407282702258367726551292949276478302283365758654388095557202147107693063638232912598498439805960866571776128157562869249540687561326901969851229705248157494412716795536617485874928328884253043159166953971992309846319441730059436713807550503780907287938041242764808454486287023
# e: 11482685017819657772146196533057795733473449629855289693100164822097723844966138177362511509772380353831218660693991845555704097147035306958570110974439828105301049643719991559075905686792619567403740919201379127416674307003242767236082047328240271052874236417166735391996411110944467555336448767975263755538261304581405836813138939268114431131030122076716110715178499142704121740475206968272546304252509000120167141777229963404829961350506433927568085505890377296146907922613025051900945495785850823000233847703348763563935446095561235796206511113603398775388472794084369294787467785140078624603886943660133858662073
# d: 6790868203158235630829276584520781742736789439092826195998797654123576347733572735958718971497900958255627200126351007473832666320814528828633214007567537
# p: 138883150480380728237623434927246886178672161731739427780189940726876139363708016727593064716237398549712491750805377758114810396003931139310206289466838423929679148600632388895987906638718077447108624380800475443167879047146541998680316977237604519562212651578127233158417320415566284948347985773323464078101
# q: 146206402301887624548377571957539294499109590440289496458019349415322189521809163434243887689560679139102346295052135494145095907084392825399549304703000838569698385543321533940487070856706709941069015683883473118618103003112832066818420293139183996027685764668723325326166936892077336816452018887234415820723


./RsaCtfTool/RsaCtfTool.py -n 0xa0d9f425fe1246c25b8c3708b9f6d7747dd5b5e7f79719831c5cbe19fb7bab66ed62719b3fc6090120d2cfe1410583190cd650c32a4151550732b0fc97130e5f02aa26cb829600b6ab452b5b11373ec69d4eaae6c392d92da8bcbea85344af9d4699e36fdca075d33f58049fd0a9f6919f3003512a261a00985dc3d9843a822974df30b81732a91ce706c44bde5ff48491a45a5fa8d5d73bba5022af803ab7bd85250e71fc0254fcf078d21eaa5d38724014a85f679e8a7a1aad6ed22602465f90e6dd8ef95df287628832850af7e3628ad09ff90a6dbdf7a0e6d74f508d2a6235d4eae5a828ac95558bbdf72f39af5641dfe3edb0cdaab362805d926106e2af -e 0x5af5dbe4af4005564908a094e0eabb0a921b7482483a753e2a4d560700cb2b2dc9399b608334e05140f54d90fcbef70cec097e3f75395d0c4799d9ec3e670aca41da0892a7b3d038acb7a518be1ced8d5224354ce39e465450c12be653639a8215afb1ba70b1f8f71fc1a0549853998e2337604fca7edac67dd1e7ddeb897308ebf26ade781710e6a2fe4c533a584566ea42068d0452c1b1ecef00a781b6d31fbab893de0c9e46fce69c71cefad3119e8ceebdab25726a96aaf02a7c4a6a38d2f75f413f89064fef14fbd5762599ca8eb3737122374c5e34a7422ea1b3d7c43a110d3209e1c5e23e4eece9e964da2c447c9e5e1c8a6038dc52d699f9324fd6b9 --decrypt 0x731ceb0ac8f10c8ff82450b61b414c4f7265ccf9f73b8e238cc7265f83c635575a9381aa625044bde7b34ad7cce901fe7512c934b7f6729584d2a77c47e8422c8c0fe2d3dd12aceda8ef904ad5896b971f8b79048e3e2f99f600bf6bac6cad32f922899c00fdc2d21fcf3d0093216bfc5829f02c08ba5e534379cc9118c347763567251c0fe57c92efe0a96c8595bac2c759837211aac914ea3b62aae096ebb8cb384c481b086e660f0c6249c9574289fe91b683609154c066de7a94eafa749c9e92d83a9d473cc88accd9d4c5754ccdbc5aa77ba9a790bc512404a81fc566df42b652a55b9b8ffb189f734d1c007b6cbdb67e14399182016843e27e6d4e5fca --attack 

# wienerpctf{fun_w1th_l4tt1c3s_f039ab9}
```